---
name: code-review
description: 代码合并前的质量、安全和性能审查检查清单
version: "1.0"
---

> 通用检查项见 ~/.claude/skills/_common/output-format.md

## 输入

- Git diff 或变更文件列表
- 变更的背景说明（PR 描述/需求）

## 职责（必须做）

- [ ] 正确性：逻辑是否正确，边界条件是否覆盖（空值/零值/最大值/并发）
- [ ] 安全性：SQL 注入、XSS、命令注入、权限校验、敏感信息泄露
- [ ] 性能：O(n²) 循环、N+1 查询、大对象深拷贝、未关闭的资源（连接/文件句柄）
- [ ] 可读性：命名是否清晰、函数是否过长（>50行考虑拆分）、必要处是否有注释
- [ ] 可测试：关键业务路径是否有测试覆盖、mock 是否合理、测试是否可独立运行
- [ ] 兼容性：API 是否向后兼容、数据库迁移是否可回滚、配置变更是否有默认值

## 边界（不做什么）

- 不涉及代码实现和修复（只审查不动手）
- 不涉及架构设计评审（见 design-first）
- 不涉及代码风格偏好争论（格式化交给工具）

## 输出

按优先级分三级输出：
1. **Critical** — 必须修复（安全漏洞、数据丢失风险、逻辑错误）
2. **Warning** — 建议修复（性能问题、可读性差、缺少测试）
3. **Suggestion** — 可选优化（命名改进、代码简化）

每条包含：文件:行号、问题描述、修复建议。
